{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport { userInput } from \"../main\";\nimport { page } from \"../main\";\n\nexport let per_page = 15;\n\nexport async function fetchPhotos() {\n  const params = new URLSearchParams({\n    page: page,\n    per_page: per_page,\n  });\n  const apiKey = '42261083-50fe706ca9c2c1734499a9937';\n  const query = userInput.value.trim();\n  const response = await axios.get(\n    `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(\n      query\n    )}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${per_page}`\n  );\n  return response.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { gallery } from '../main';\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\nexport function renderPhotos(data) {\n  const markup = data.hits\n    .map(data => {\n      return `<li class=\"gallery-item\"><a href=\"${data.webformatURL}\">\n        <img class=\"gallery-image\" src=\"${data.webformatURL}\" alt=\"${data.tags}\"></a>\n        <div class=\"modat-text\">\n          <div class=\"modal-element\"><p>Likes</p><span>${data.likes}</span></div>\n          <div class=\"modal-element\"><p>Views</p><span>${data.views}</span></div>\n          <div class=\"modal-element\"><p>Comments</p><span>${data.comments}</span></div>\n          <div class=\"modal-element\"><p>Downloads</p><span>${data.downloads}</span></div>\n        </div>\n      </li>`;\n    })\n    .join('');\n\n  if (lightbox) {\n    lightbox.destroy();\n  }\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    captionDelay: 250,\n  });\n  lightbox.on('show.simplelightbox', function (e) {\n    const { alt } = e.target.querySelector('img');\n    e.caption.innerHTML = alt;\n  });\n  lightbox.refresh();\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchPhotos } from './js/pixabay-api';\nimport { renderPhotos } from './js/render-functions';\nimport { per_page } from './js/pixabay-api';\n\nconst fetchPicturesForm = document.querySelector('.form');\nexport const gallery = document.querySelector('.gallery');\nexport const userInput = document.querySelector('input');\nconst container = document.querySelector('.container');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nexport let page = 1;\nlet totalPages;\n\nconst showLoader = () => {\n    const loader = document.createElement('span');\n    loader.classList.add('loader');\n    container.append(loader);\n};\n\nconst hideLoader = () => {\n    const loader = document.querySelector('.loader');\n    if (loader) {\n        loader.remove();\n    }\n};\n\nconst showLoadMoreButton = () => {\n    loadMoreBtn.style.display = 'block';\n};\n\nconst hideLoadMoreButton = () => {\n    loadMoreBtn.style.display = 'none';\n};\n\nfunction shouldHideLoadMoreButton(loadedImagesCount, totalImagesCount) {\n    return loadedImagesCount >= totalImagesCount;\n}\n\nfetchPicturesForm.addEventListener('submit', async e => {\n    showLoader();\n    page = 1;\n    e.preventDefault();\n    hideLoadMoreButton();\n    gallery.innerHTML = '';\n    const userQuery = userInput.value.trim();\n    if (userQuery === '') {\n        hideLoader();\n        return;\n    }\n    try {\n        const photos = await fetchPhotos();\n        renderPhotos(photos);\n        hideLoader();\n        showLoadMoreButton();\n\n        if (photos.hits.length === 0) {\n            iziToast.error({\n                title: '',\n                backgroundColor: '#EF4040',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n            });\n\n            const { height: cardHeight } = document\n                .querySelector('.gallery')\n                .firstElementChild.getBoundingClientRect();\n            window.scrollBy({\n                top: cardHeight * 2,\n                behavior: 'smooth',\n            });\n        }\n\n        if (shouldHideLoadMoreButton(per_page, photos.totalHits)) {\n            hideLoadMoreButton();\n        } else {\n            showLoadMoreButton();\n            totalPages = Math.ceil(photos.totalHits / per_page);\n        }\n\n        fetchPicturesForm.reset(); // Очистити форму після успішного завершення обробки\n    } catch (error) {\n        hideLoadMoreButton();\n    }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n    showLoader();\n    try {\n        page += 1;\n        const photos = await fetchPhotos();\n        renderPhotos(photos);\n        hideLoader();\n\n        const { height: cardHeight } = document\n            .querySelector('.gallery')\n            .firstElementChild.getBoundingClientRect();\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: 'smooth',\n        });\n\n        if (page >= totalPages) {\n            iziToast.warning({\n                title: '',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n            hideLoadMoreButton();\n        }\n    } catch (error) {\n        hideLoader();\n        hideLoadMoreButton();\n    }\n});\n"],"names":["per_page","fetchPhotos","page","apiKey","query","userInput","axios","lightbox","SimpleLightbox","renderPhotos","data","markup","gallery","alt","fetchPicturesForm","container","loadMoreBtn","totalPages","showLoader","loader","hideLoader","showLoadMoreButton","hideLoadMoreButton","shouldHideLoadMoreButton","loadedImagesCount","totalImagesCount","e","photos","iziToast","cardHeight"],"mappings":"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"}